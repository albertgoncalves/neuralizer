#!/usr/bin/env bash

if [ $(uname -s) = "Darwin" ]; then
    alias ls='ls --color=auto'
    alias ll='ls -l'
else
    alias open="xdg-open"
fi

if [ ! -e node_modules/.bin/jshint ]; then
    npm install --save-dev jshint
fi

export PATH=$PWD/node_modules/.bin/:$PATH
export WD=$(pwd)
export HTML_TIDY=$WD/.tidyrc

fmt () {
    tidy -q -m $WD/src/index.html
    sed -i 's/[ \t]\+$//' "$WD/src/index.html"
    for f in $WD/src/js/*.js; do
        echo $f
        clang-format -i $f
    done
}

export -f fmt
alias jshint="
    jshint -c $WD/.jshint --show-non-errors $WD/src/js/main.js
    jshint $WD/src/js/
"
